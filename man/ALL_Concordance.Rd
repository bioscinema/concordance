% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{ALL_Concordance}
\alias{ALL_Concordance}
\title{Calculate Overall Taxa Concordance Across Multiple Taxonomic Levels}
\usage{
ALL_Concordance(physeq)
}
\arguments{
\item{physeq}{A phyloseq object containing sample data and an OTU table. It is assumed that sample names
in the phyloseq object correspond to subjects, and that each subject has associated samples with suffixes
"-wgs" and "-16s" for WGS and 16S data, respectively.}
}
\value{
A data frame with one row per subject containing:
  \describe{
    \item{Subject}{The subject identifier.}
    \item{IPAC}{Overall inverse Presence/Absence Concordance, defined as
        \eqn{1 - \frac{\sum (BL \times |(wgs > 0) - (16s > 0)|)}{\sum (BL \times ((wgs > 0) + (16s > 0)))}}, summed over levels.}
    \item{IWPAC}{Overall inverse Weighted Presence/Absence Concordance, defined as
        \eqn{1 - \frac{\sum (BL \times |wgs - 16s|)}{\sum (BL \times 2)}}, summed over levels.}
  }
}
\description{
This function computes overall concordance metrics between WGS and 16S data across
several taxonomic levels (Phylum, Class, Order, Family, and Genus) for a given phyloseq object.
For each level, the function aggregates the data to relative abundances and calculates two metrics:
the Presence/Absence Concordance (PAC) and the Weighted Presence/Absence Concordance (WPAC). Each metric
is weighted by a branch length factor (BL), which is set to 1 for Genus, 2 for Family, 3 for Order,
4 for Class, and 5 for Phylum. The overall metrics, IPAC and IWPAC, are computed by summing the numerators
and denominators across all levels and then calculating 1 minus the ratio.
}
\details{
The function iterates over the taxonomic levels "Phylum", "Class", "Order", "Family", and "Genus".
For each level, the phyloseq object is aggregated and transformed to relative abundances. For each subject,
the function extracts count data for the corresponding WGS and 16S samples (using sample names with suffixes
"-wgs" and "-16s") and computes:
\itemize{
  \item \strong{PAC:} The numerator is \code{BL * sum(abs((wgs > 0) - (16s > 0)))}, and the denominator is
        \code{BL * sum((wgs > 0) + (16s > 0))}.
  \item \strong{WPAC:} The numerator is \code{BL * sum(abs(wgs - 16s))} and the denominator is \code{BL * 2}.
}
The branch length factor BL is assigned according to the taxonomic level:
\itemize{
  \item Genus: BL = 1
  \item Family: BL = 2
  \item Order: BL = 3
  \item Class: BL = 4
  \item Phylum: BL = 5
}
The overall inverse concordance metrics (IPAC and IWPAC) for each subject are computed as 1 minus the ratio
of summed numerators to summed denominators across all levels.
}
