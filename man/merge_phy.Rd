% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{merge_phy}
\alias{merge_phy}
\title{Merge 16S and WGS Phyloseq Objects with Taxonomy and Phylogeny Adjustment}
\usage{
merge_phy(phylo_16s, phylo_wgs, level = "Genus")
}
\arguments{
\item{phylo_16s}{A phyloseq object containing 16S sequencing data.}

\item{phylo_wgs}{A phyloseq object containing WGS sequencing data.}

\item{level}{A character string specifying the taxonomic level to which the data should be aggregated.
Default is \code{"Genus"}.}
}
\value{
A merged and processed phyloseq object with updated sample names, taxonomy, and phylogenetic tree.
}
\description{
This function processes two phyloseq objectsâ€”one containing 16S sequencing data and
one containing WGS sequencing data. It aggregates the data to a specified taxonomic level,
updates sample names and metadata to indicate the sequencing platform, standardizes the taxonomic
tables, merges the two objects, fixes duplicate taxa using \code{BAZE::fix_duplicate_tax}, and
updates the phylogenetic tree tip labels by removing any leading taxonomic prefix.
}
\details{
The function performs the following steps:
\enumerate{
  \item Aggregates taxa for both 16S and WGS objects to the specified level using \code{aggregate_taxa}.
  \item Modifies sample names by appending \code{"-16s"} or \code{"-wgs"} to indicate the data source.
  \item Updates sample metadata to include a \code{Platform} column.
  \item Standardizes the taxonomic tables by renaming columns to \code{"Kingdom"}, \code{"Phylum"},
        \code{"Class"}, \code{"Order"}, \code{"Family"}, \code{"Genus"}, and \code{"unique"}.
  \item Merges the two phyloseq objects and processes the merged taxonomic table by removing the
        \code{"unique"} column and converting taxonomic columns to factors.
  \item Fixes duplicate taxa using \code{BAZE::fix_duplicate_tax}.
  \item Adjusts the phylogenetic tree by removing any leading taxonomic prefix (matching \code{"^[a-z]__"})
        from the tip labels.
}
}
