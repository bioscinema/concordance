% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EstPara.R
\name{EstPara}
\alias{EstPara}
\title{Estimate Dirichlet Parameters and Simulate OTU Table}
\usage{
EstPara(ref.otu.tab)
}
\arguments{
\item{ref.otu.tab}{A matrix of raw OTU counts (rows = OTUs, columns = samples).
Row names should be OTU names and column names should be sample names.}
}
\value{
A list with the following components:
\describe{
  \item{\code{mu}}{Estimated OTU proportions matrix (OTUs × Samples) after Dirichlet smoothing.}
  \item{\code{ref.otu.tab}}{Simulated OTU count matrix (OTUs × Samples) after applying size factors.}
}
}
\description{
This function estimates the Dirichlet hyperparameters using the \code{dirmult} package
and generates a simulated OTU count matrix and proportion matrix. It adds a pseudocount
based on the estimated Dirichlet parameters and applies sample-specific size factors.
}
\details{
This function performs the following steps:
\enumerate{
  \item Estimates Dirichlet parameters using the \code{dirmult} package.
  \item Adds a pseudocount to each OTU count based on the estimated Dirichlet parameters.
  \item Converts the adjusted counts into OTU proportions using the Dirichlet distribution.
  \item Applies randomly sampled size factors (from a log-normal distribution) to simulate sequencing depth variability.
}

OTUs are ordered by mean abundance across all samples.
}
\seealso{
\code{\link[dirmult]{dirmult}}
}
