% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{Taxa_Concordance}
\alias{Taxa_Concordance}
\title{Calculate Taxa Concordance between WGS and 16S Sequencing Data}
\usage{
Taxa_Concordance(physeq, level = "Phylum")
}
\arguments{
\item{physeq}{A phyloseq object containing sequencing data, taxonomic assignments, and sample metadata.}

\item{level}{Character string specifying the taxonomic level to which the data should be aggregated.
Default is "Phylum".}
}
\value{
A data frame with one row per subject containing:
  \describe{
    \item{Subject}{The subject identifier.}
    \item{PAC}{The Presence/Absence Concordance between WGS and 16S data, computed as
      \eqn{1 - \frac{\sum |(count\_wgs > 0) - (count\_16s > 0)|}{\sum ((count\_wgs > 0) + (count\_16s > 0))}}.}
    \item{WPAC}{The Weighted Presence/Absence Concordance, computed as
      \eqn{1 - \frac{\sum |count\_wgs - count\_16s|}{2}}.}
  }
}
\description{
This function computes the concordance between taxa detection in whole genome shotgun sequencing
(WGS) and 16S rRNA gene sequencing. It first aggregates taxonomic counts to a specified level (e.g., "Phylum")
and transforms the counts to relative abundances. Then, for each subject, the function calculates two concordance
metrics: the Presence/Absence Concordance (PAC) and the Weighted PAC (WPAC).
}
\details{
The function aggregates taxa using \code{aggregate_taxa} and converts the OTU counts to relative abundances
via \code{transform_sample_counts}. It assumes that the OTU table contains columns for both WGS and 16S data,
with column names following the format \code{<subject>-wgs} and \code{<subject>-16s} respectively. For each subject,
the function calculates the PAC metric based on the presence or absence of taxa and the WPAC metric based on the
absolute differences in relative abundances.
}
